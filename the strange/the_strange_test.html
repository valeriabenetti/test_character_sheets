<!-- Sheet Width: 842px; -->
<div class="background">

  <!-- Header+Tier+Effort+XP -->
  <div>
    <div class="sheet-col">
      <img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/The%20Strange/images/The%20Strange%20Logo/The-Strange-Logo-Color-Large.png" align="center">
    </div>
    <div class="sheet-col">
      <table width="100%" height="200px" align="center">
        <tbody style="border: 0px;">
          <tr>
            <td class="circlebox"><input class="circle" type="text" name="attr_tier"></td>
            <td class="circlebox"><input class="circle" type="text" name="attr_effort"></td>
            <td class="circlebox"><input class="circle" type="text" name="attr_xp"></td>
          </tr>
          <tr>
            <td class="circlelabel"><span data-i18n="tier-u">TIER</span></td>
            <td class="circlelabel"><span data-i18n="effort-u">EFFORT</span></td>
            <td class="circlelabel"><span data-i18n="xp-u">XP</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div>
    <!-- Name+Desc+Type -->
    <div class="charinfo">
      <input name="attr_character_name" class="primary" type="text" data-i18n-placeholder="name-u" placeholder="NAME" style="width: 300px;"><label class="spacer"></label>
      <h3 style="display: inline;" data-i18n="is-a-u"> IS A </h3>
      <input name="attr_descriptor" class="primary" type="text" data-i18n-placeholder="descriptor-u" placeholder="DESCRIPTOR" style="width: 200px;">
      <input name="attr_type" class="primary" type="text" data-i18n-placeholder="type-u" placeholder="TYPE" style="width: 150px;">
      <h3 style="display: inline;" data-i18n="who-u"> WHO</h3><label class="spacer"></label>
      <input name="attr_focus" class="primary" type="text" data-i18n-placeholder="focus-u" placeholder="FOCUS" style="width: 250px;">
      <h3 style="display: inline;" data-i18n="on-u"> ON </h3>
      <input name="attr_recursion" class="primary" type="text" data-i18n-placeholder="recursion-u" placeholder="RECURSION" style="width: 150px;">
    </div>

    <!-- Roll vs A Difficult -->
    <div class="rvd">
      <div style="display:none;">
        <span data-i18n="success">Success</span>
      </div>
      <table width="100%" align="center">
        <tbody style="border: 0px;">
          <tr>
            <td class="header" colspan="10">&bull;<span data-i18n="rvd-u">ROLL VS A DIFFICULTY</span>&bull;</td>
          </tr>
          <tr>
            <td class="rvdbx" data-i18n="simple">Simple</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{simple}}} {{result=[[1d20>3]] ^{success}}}"><b>1</b></button></td>
            <td class="rvdbx" data-i18n="intimidating">Initmidating</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{intimidating}}} {{result=[[1d20>18]] ^{success}}}"><b>6</b></button></td>
          </tr>
          <tr>
            <td class="rvdbx" data-i18n="standard">Standard</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{standard}}} {{result=[[1d20>6]] ^{success}}}"><b>2</b></button></td>
            <td class="rvdbx" data-i18n="formidable">Formidable</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{formidable}}} {{result=[[1d20>21]] ^{success}}}"><b>7</b></button></td>
          </tr>
          <tr>
            <td class="rvdbx" data-i18n="demanding">Demanding</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{demanding}}} {{result=[[1d20>9]] ^{success}}}"><b>3</b></button></td>
            <td class="rvdbx" data-i18n="heroic">Heroic</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{heroic}}} {{result=[[1d20>24]] ^{success}}}"><b>8</b></button></td>
          </tr>
          <tr>
            <td class="rvdbx" data-i18n="difficult">Difficult</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{difficult}}} {{result=[[1d20>12]] ^{success}}}"><b>4</b></button></td>
            <td class="rvdbx" data-i18n="immortal">Immortal</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{immortal}}} {{result=[[1d20>27]] ^{success}}}"><b>9</b></button></td>
          </tr>
          <tr>
            <td class="rvdbx" data-i18n="challenging">Challenging</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{challenging}}} {{result=[[1d20>15]] ^{success}}}"><b>5</b></button></td>
            <td class="rvdbx" data-i18n="impossible">Impossible</td>
            <td class="rvdbtn"><button type="roll" value="&{template:default} {{name=@{character_name}}} {{Difficulty=^{impossible}}} {{result=[[1d20>30]] ^{success}}}"><b>10</b></button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <br/>

  <div>
    <!-- Recursion Stats -->
    <div class="recursion">
      <table width="100%" align="center">
        <tbody>
          <tr>
            <td class="header" colspan="2" width="33%">&bull;<span data-i18n="might-u">MIGHT</span>&bull;</td>
            <td class="header" colspan="2" width="33%">&bull;<span data-i18n="speed-u">SPEED</span>&bull;</td>
            <td class="header" colspan="2" width="33%">&bull;<span data-i18n="intellect-u">INTELLECT</span>&bull;</td>
          </tr>
          <tr>
            <td class="attrbox" colspan="2"><span class="circle" type="text" name="attr_mightpool"></span></td>
            <td class="attrbox" colspan="2"><input class="circle" type="text" name="attr_speedpool"></td>
            <td class="attrbox" colspan="2"><input class="circle" type="text" name="attr_intellectpool"></td>
          </tr>
          <tr>
            <td><input class="centerinput" data-i18n-placeholder="pool-u" placeholder="POOL" type="text" name="attr_mightpoolmax"></td>
            <td><input class="centerinput" data-i18n-placeholder="edge-u" placeholder="EDGE" type="text" name="attr_mightedge"></td>
            <td><input class="centerinput" data-i18n-placeholder="pool-u" placeholder="POOL" type="text" name="attr_speedpoolmax"></td>
            <td><input class="centerinput" data-i18n-placeholder="edge-u" placeholder="EDGE" type="text" name="attr_speededge"></td>
            <td><input class="centerinput" data-i18n-placeholder="pool-u" placeholder="POOL" type="text" name="attr_intellectpoolmax"></td>
            <td><input class="centerinput" data-i18n-placeholder="edge-u" placeholder="EDGE" type="text" name="attr_intellectedge"></td>
          </tr>
        </tbody>
      </table>
      <!-- Skills -->
      <table width="100%" height="500px" align="center">
        <tbody>
          <tr>
            <td class="header" colspan="6">&bull;<span data-i18n="skills">SKILLS</span>&bull;</td>
          </tr>
          <tr>
            <td class="skillbox">
              <fieldset class="repeating_skills">
                <table align="center" width="100%">
                  <tbody>
                    <tr>
                      <td>
                        <tr>
                          <td><input type="text" name="attr_skill-name" data-i18n-placeholder="skill-u" placeholder="SKILL" style="width: 220px;"></td>
                          <td><input type="checkbox" name="attr_trained-skill"><br>T</td>
                          <td><input type="checkbox" name="attr_specialized-skill"><br>S</td>
                        </tr>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </fieldset>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- Attacks-->
      <table width="100%" align="center">
        <tbody>
          <tr>
            <td class="header" colspan="6">&bull;<span data-i18n="attacks-u">ATTACKS</span>&bull;</td>
          </tr>
          <tr>
            <td class="attackbox">
              <fieldset class="repeating_attacks">
                <table align="center" width="100%">
                  <tbody>
                    <tr>
                      <td>
                        <tr>
                          <td class="attackbox"><input type="text" data-i18n-placeholder="attack-u" placeholder="ATTACK" name="attr_attack-name"></td>
                          <td class="attackboxsmall"><input class="centerinput" type="text" data-i18n-placeholder="mod-u" placeholder="MOD" name="attr_attack-mod">
                          <td class="attackboxsmall"><input class="centerinput" type="text" data-i18n-placeholder="dmg-u" placeholder="DMG" name="attr_attack-dmg">
                        </tr>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </fieldset>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Special Abilities-->
      <table width="100%" align="center">
        <tbody>
          <tr>
            <td class="header">&bull;<span data-i18n="special_abilities-u">SPECIAL ABILITIES</span>&bull;</td>
          </tr>
          <td class="specialabilbox">
            <div class="orangeparent"><textarea type="text" name="attr_special_abilites"></textarea>

            </div>
          </td>
        </tbody>
      </table>

      <!-- Equipment -->
      <table width="100%" align="center">
        <tbody>
          <tr>
            <td class="header">&bull;<span data-i18n="equipment-u">EQUIPMENT</span>&bull;</td>
          </tr>
          <tr>
            <td class="equipmentbox">
              <div class="orangeparent"><textarea type="text" name="attr_equipment">                  &#13;&#10;                  &#13;&#10;                  &#13;&#10;                  &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;</textarea>
                <div class="armorcirclebox"><input class="orangecircle" type="text" name="attr_armor">
                  <p class="orangecircle2" data-i18n="armor-u">ARMOR</p>
                </div>
                <div class="moneycirclebox"><input class="orangecircle" type="text" name="attr_money">
                  <p class="orangecircle2" data-i18n="money-u">MONEY</p>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Cyphers+Limit+Recovery+Damage Track+Advancement+Rolls -->
    <div class="cyphers">
      <table width="100%" align="center">
        <tbody>
          <tr>
            <td class="header" colspan="2">&bull;<span data-i18n="cyphers-u">CHYPHERS</span>&bull;</td>
          </tr>
          <tr>
            <td class="cypherbox">
              <div class="orangeparent"><textarea type="text" name="attr_cyper"></textarea>
                <div class="limitcirclebox"><input class="orangecircle" type="text" name="attr_cypher-limit">
                  <p class="orangecircle2" data-i18n="limit-u">LIMIT</p>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- Recovery -->
      <table width="100%" align="center">
        <tbody class="recoveryrow">
          <tr>
            <td class="header" colspan="5">&bull;<span data-i18n="recovery_roll-u">RECOVERY ROLL</span>&bull;</td>
          </tr>
          <tr>
            <td class="recovery"><input type="checkbox" name="attr_recovery_1action"></td>
            <td class="recovery"><input type="checkbox" name="attr_recovery_10min"></td>
            <td class="recoverycirclebox" rowspan="2"><button type="roll" name="roll_recovery" value="/roll 1d6+@{recoverybonus}" class="recoverybtn"><b>1d6+</b></button><input class="circle" type="text" name="attr_recoverybonus"></td>
            <td class="recovery"><input type="checkbox" name="attr_recovery_1hr"></td>
            <td class="recovery"><input type="checkbox" name="attr_recovery_10hr"></td>
          </tr>
          <tr>
            <td class="recovery2" data-i18n="action-u">1 ACTION</td>
            <td class="recovery2" data-i18n="minutes-u">10 MINS</td>
            <td class="recovery2" data-i18n="hour-u">1 HOUR</td>
            <td class="recovery2" data-i18n="hours-u">10 HOURS</td>
          </tr>
        </tbody>
      </table>
      <!-- Damage Track -->
      <table width="100%" align="center">
        <tbody class="recoveryrow">
          <tr>
            <td class="header" colspan="2">&bull;<span data-i18n="damage_track-u">DAMAGE TRACK</span>&bull;</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_impared"></td>
            <td class="dmgtrk" rowspan="2" data-i18n="dmgtrk-text-u">+1 EFFORT PER LEVEL<br/>IGNORE MINOR & MAJOR EFFECT RESULTS<br/>COMBAT ROLLS OF 17-20 ONLY DEAL +1 DAMAGE</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx2" data-i18n="impaired-u">IMPAIRED</td>
          </tr>
          <td class="dmgtrkchbx"><input type="checkbox" name="attr_debilitated"></td>
          <td class="dmgtrk" rowspan="2" data-i18n="debilitated_text-u">CAN ONLY MOVE AN IMMEDIATE DISTANCE<br/>IF SPEED POOL IS ZERO YOU CANNOT MOVE</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx2" data-i18n="debilitated-u">DEBILITATED</td>
          </tr>
        </tbody>
      </table>
      <!--Advancements -->
      <table width="100%" align="center">
        <tbody class="recoveryrow">
          <tr>
            <td class="header" colspan="5">&bull;<span data-i18n="advancement-u">ADVANCEMENT</span>&bull;</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx" colspan="5" data-i18n="advancement-text">(You must have four of these to advance in Tier. Cost = 4XP each.)</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_increase_capabilities"></td>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_move_twoards_perfection"></td>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_extra_effort"></td>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_skill_training"></td>
            <td class="dmgtrkchbx"><input type="checkbox" name="attr_other"></td>
          </tr>
          <tr>
            <td class="dmgtrkchbx2" data-i18n="increase_capabilities-u">INCREASE CAPABILITIES</td>
            <td class="dmgtrkchbx2" data-i18n="move_towards_perfections-u">MOVE TOWARDS PERFECTION</td>
            <td class="dmgtrkchbx2" data-i18n="extra_effort-u">EXTRA EFFORT</td>
            <td class="dmgtrkchbx2" data-i18n="skill_training-u">SKILL TRAINING</td>
            <td class="dmgtrkchbx2" data-i18n="other-u">OTHER</td>
          </tr>
          <tr>
            <td class="dmgtrkchbx" data-i18n="points_in_stat_pool">+4 points into stat Pools</td>
            <td class="dmgtrkchbx" data-i18n="point_in_edge_choice">+1 point into the Edge of your choice</td>
            <td class="dmgtrkchbx" data-i18n="point_into_effort">+1 point into Effort</td>
            <td class="dmgtrkchbx" data-i18n="skill_or_specialize">Train in a skill or Specialize</td>
            <td class="dmgtrkchbx" data-i18n="refer_to_corebook">Refer to corebook</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>


</div>

<div class="footer" style="font-size: 10px; color: rgb(165, 165, 165);">
  <span>
        &copy;2015 Monte Cook Games, LLC. The Strange are trademarks of Monte Cook Games, LLC, in the U.S.A. and other countries. All Monte Cook Games characters and character names, and the distinctive likeness thereof, are trademarks of Monte Cook Games, LLC.
    </span>
</div>

<script type="text/worker">
  on("sheet:opened", function() {
    var getRequest = ["version"],

    //This get is too big. Just get "version" first to check if the upgrade needs to be done
    getAttrs(getRequest, function(values){
      if(!values.version){

        // Updating, adding, and saving values for skills
        // Move this to after the version check
        for(var x=1; x<22; x++){
          getRequest.push("checkboxt" + x);
          getRequest.push("checkboxs" + x);
          getRequest.push("skill" + x);
        };

        // Updating, adding, and saving the attacks
        // Move this to after the version check
        for(var y=1; y<10; y++){
          getRequest.push("attack" + y);
          getRequest.push("mod" + y);
          getRequest.push("dmg" + y);
        }

        //put your second get request here
        console.log("Updating to v. 1.0");
        var newrowattrs = {version: 1.0};
        for(var x=1; x<22; x++){
          if(values["skill" + x]){
            var rowId = generateRowID();
            newrowattrs["repeating_skills_" + rowId + "_skill-name"] = values["skill" + x];
            if(values["checkboxt" + x]) {
              newrowattrs["repeating_skills_" + rowId + "_trained-skill"] = values["checkboxt" + x];
            };
            if(values["checkboxt" + x]) {
              newrowattrs["repeating_skills_" + rowId + "_specialized-skill"] = values["checkboxs" + x];
            };
          };
        };
        for(var y=1; y<10; y++){
          if(values["attack" + y]){
            var rowId = generateRowID();
            newrowattrs["repeating_attacks_" + rowId + "_attack-name"] = values["attack" + y];
            if(values["mod" + y]) {
              newrowattrs["repeating_attacks_" + rowId + "_attack-mod"] = values["mod" + y];
            };
            if(values["dmg" + y]){
              newrowattrs["repeating_attacks_" + rowId + "_attack-dmg"] = values["dmg" + y];
            };
          };
        };
        setAttrs(newrowattrs);
        getAttrs(getRequest);
      };
    });
</script>
